# Rime schema
# encoding: utf-8

schema:
  schema_id: flypy_aux
  name: 鹤
  version: "0.1"
  author:
    - Alex Lu
  description: |
    快手/小鹤双形方案
  dependencies:
    - stroke
    - emoji

switches:
  - name: zh_simp
    reset: 1
    states: ["漢", "汉"]
  - name: full_shape
    states: ["half", "full"]
  - name: extended_charset
    states: ["basic", "ext"]

engine:
  processors:
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - affix_segmentor@emoji
    - fallback_segmentor
  translators:
    - punct_translator
    - reverse_lookup_translator
    - script_translator
    - lua_translator@tex_translator
    - lua_translator@func_translator
    - table_translator@emoji
    - table_translator@custom_phrase
    - table_translator
  filters:
    - simplifier
    - uniquifier

simplifier:
  option_name: zh_simp

speller:
  alphabet: "zyxwvutsrqponmlkjihgfedcba;:"
  initials: "zyxwvutsrqponmlkjihgfedcba"
  delimiter: " '"
  algebra:
    - erase/^xx$/
    - derive/^([aoe])(.*)$/$1$1$2/
    - xform/^ch/I/
    - xform/^sh/U/
    - xform/^zh/V/
    - xform/iang/L/
    - xform/uang/L/
    - xform/iong/R/
    - xform/(\w+)ang/$1Y/
    - xform/(\w+)eng/$1P/
    - xform/(\w+)ong/$1R/
    - xform/ian/M/
    - xform/iao/K/
    - xform/ing/;/
    - xform/uai/G/
    - xform/uan/D/
    - xform/(\w+)ai/$1T/
    - xform/(\w+)an/$1N/
    - xform/(\w+)ao/$1C/
    - xform/(\w+)ei/$1W/
    - xform/(\w+)en/$1S/
    - xform/(\w)ia/$1X/
    - xform/(\w)ie/$1J/
    - xform/(\w)in/$1F/
    - xform/(\w)iu/$1Q/
    - xform/(\w+)ou/$1Z/
    - xform/(\w+)ua/$1X/
    - xform/(\w)ue/$1B/
    - xform/(\w+)ui/$1V/
    - xform/(\w+)un/$1H/
    - xform/(\w+)uo/$1O/
    - xform/(\w)ve/$1B/
    - xlit/QWERTYUIOPSDFGHJKLZXCVBNMA/qwertyuiopsdfghjklzxcvbnma/
    - abbrev/^(.).+$/$1/
    - derive/^(..:.).+$/$1/
    - derive/^(..):..$/$1/

translator:
  dictionary: flypy_aux
  preedit_format:
    - erase/^;.*/
    - xform/(\w\w)(\w+)/$1:$2/
    - xform/(?<!:)([bpmfdtnljqx])k/$1iao/
    - xform/(?<!:)(\w)w/$1ei/
    - xform/(?<!:)([dtnlgkhjqxyvuirzcs])d/$1uan/
    - xform/(?<!:)(\w)b/$1ve/
    - xform/(?<!:)(\w)q/$1iu/
    - xform/(?<!:)([dtnlgkhvuirzcs])o/$1uo/
    - xform/(?<!:)(\w)h/$1ie/
    - xform/(?<!:)(\w)t/$1ai/
    - xform/(?<!:)(\w)n/$1an/
    - xform/(?<!:)(\w)s/$1en/
    - xform/(?<!:)(\w)y/$1ang/
    - xform/(?<!:)(\w)p/$1eng/
    - xform/(?<!:)([jqx])r/$1iong/
    - xform/(?<!:)(\w)r/$1ong/
    - xform/(?<!:)(\w)j/$1un/
    - xform/(?<!:)([gkhvui])g/$1uai/
    - xform/(?<!:)(\w);/$1ing/
    - xform/(?<!:)([bjqxnl])l/$1iang/
    - xform/(?<!:)([gkhviu])l/$1uang/
    - xform/(?<!:)(\w)z/$1ou/
    - xform/(?<!:)([gkhvuirzcs])x/$1ua/
    - xform/(?<!:)(\w)x/$1ia/
    - xform/(?<!:)(\w)c/$1ao/
    - xform/(?<!:)([dtgkhvuirzcs])v/$1ui/
    - xform/(?<!:)(\w)f/$1in/
    - xform/(?<!:)(\w)m/$1ian/
    - xform/(?<!:)([aoe])\1(\w)/$1$2/
    - "xform/(?<!:)(^|[ '])v/$1zh/"
    - "xform/(?<!:)(^|[ '])i/$1ch/"
    - "xform/(?<!:)(^|[ '])u/$1sh/"
    - xform/(?<!:)([jqxy])v/$1u/
    - xform/(?<!:)([nl])v/$1ü/

custom_phrase:
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

punctuator:
  import_preset: symbols
  half_shape:
    '''': { pair: [ 「, 」 ] }
    '""': { pair: [ 「, 」 ] }
  symbols:
    '\key':  [,❖,◁,⌘,⌥,⎇,⇧,⇪,↩,⌅,⌫,⌦,⌧,⌀,⌗,⏏,↖,↘,⇞,⇟,⌜,⌝,⌞,⌟,⍑]
    '\hira': [あ,い,う,え,お,か,き,く,け,こ,さ,し,す,せ,そ,た,ち,つ,て,と,な,に,ぬ,ね,の,は,ひ,ふ,へ,ほ,ま,み,む,め,も,や,い,ゆ,え,よ,ら,り,る,れ,ろ,わ,い,う,え,を]
    '\kana': [ア,イ,ウ,エ,オ,カ,キ,ク,ケ,コ,サ,シ,ス,セ,ソ,タ,チ,ツ,テ,ト,ナ,ニ,ヌ,ネ,ノ,ハ,ヒ,フ,ヘ,ホ,マ,ミ,ム,メ,モ,ヤ,イ,ユ,エ,ヨ,ラ,リ,ル,レ,ロ,ワ,イ,ウ,エ,ヲ]

key_binder:
  import_preset: default
  bindings:
    - { when: has_menu, accept: =, send: Page_Down }
    - { when: paging, accept: -, send: Page_Up }
    - { when: composing, accept: slash, send: ':' }

recognizer:
  import_preset: default
  patterns:
    reverse_lookup: "^ab[a-z]*'?$"
    emoji: "^ae[a-z]*'?$"
    tex_translator: "^al.*$"
    func_translator: "^af.*$"

reverse_lookup:
  dictionary: stroke
  enable_completion: true
  prefix: "ab"
  suffix: "'"
  tips: 〔笔画〕
  preedit_format:
    - xlit/hspnz/一丨丿丶乙/
  comment_format:
    - xform/([nl])v/$1ü/

emoji:
  tag: emoji
  dictionary: emoji
  enable_completion: true
  prefix: "ae"
  suffix: "'"
  tips: " Emoji"
